# --- Shared ---
export PATH="$PATH:$HOME/go/bin"

export EDITOR="nvim"
export VISUAL="nvim"

# Powerlevel10k instant prompt (keep near top)
if [[ -r "${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh" ]]; then
  source "${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh"
fi

# --- OS-specific plugin locations ---
{{ if eq .chezmoi.os "darwin" }}
# macOS (Homebrew)
if command -v brew >/dev/null 2>&1; then
  HOMEBREW_PREFIX="$(brew --prefix)"

  for plugin_path in \
    "$HOMEBREW_PREFIX/share/zsh-autocomplete/zsh-autocomplete.plugin.zsh" \
    "$HOMEBREW_PREFIX/share/zsh-autosuggestions/zsh-autosuggestions.zsh"; do
    if [[ -r "$plugin_path" ]]; then
      source "$plugin_path"
      break
    fi
  done

  for theme_path in \
    "$HOMEBREW_PREFIX/share/powerlevel10k/powerlevel10k.zsh-theme" \
    "$HOMEBREW_PREFIX/opt/powerlevel10k/share/powerlevel10k/powerlevel10k.zsh-theme"; do
    if [[ -r "$theme_path" ]]; then
      source "$theme_path"
      break
    fi
  done
fi
{{ else }}
# Linux (auto-detect typical system locations)
for plugin_path in \
  /usr/share/zsh-autocomplete/zsh-autocomplete.plugin.zsh \
  /usr/share/zsh/plugins/zsh-autocomplete/zsh-autocomplete.plugin.zsh \
  /usr/share/zsh-autosuggestions/zsh-autosuggestions.zsh \
  /usr/share/zsh/plugins/zsh-autosuggestions/zsh-autosuggestions.zsh; do
  if [[ -r "$plugin_path" ]]; then
    source "$plugin_path"
    break
  fi
done

for theme_path in \
  /usr/share/powerlevel10k/powerlevel10k.zsh-theme \
  /usr/share/zsh-theme-powerlevel10k/powerlevel10k.zsh-theme \
  /usr/share/zsh/themes/powerlevel10k.zsh-theme \
  "$HOME/.local/share/powerlevel10k/powerlevel10k.zsh-theme"; do
  if [[ -r "$theme_path" ]]; then
    source "$theme_path"
    break
  fi
done
{{ end }}

# Load your personal P10k config if present
[[ -f ~/.p10k.zsh ]] && source ~/.p10k.zsh

